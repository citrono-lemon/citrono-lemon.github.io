"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[528],{8528:function(t,e,n){n.r(e),n.d(e,{default:function(){return T}});var o=n(5893),i=n(7294);n(2260);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return!e||"object"!==h(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function l(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return f(this,n)}}var p=new Phaser.Geom.Rectangle(0,0,20,20),d=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(n,Phaser.Scene);var e=l(n);function n(){var t;return r(this,n),(t=e.call(this,{key:"Main"}))._frame=0,t._fallCount=0,t._tetrimino=new _("O"),t._field=new y,t._objs=[],t}return s(n,[{key:"preload",value:function(){console.log("preload")}},{key:"create",value:function(){var t=this,e=this,n=this,o=this,i=this,r=this,a=this;this.cameras.main.fadeIn(700),this._pointerText=this.add.text(10,10,"",{fontSize:"14px"}),this._counter=this.add.text(10,34,this._frame.toString(),{fontSize:"14px"}),this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.M).on("down",(function(){t._tetrimino=new _("O")}),this),this.input.keyboard.addKey("s").on("down",(function(){e._tetrimino.position==e._tetrimino.move("Down",e._field).position&&(e._field.put(e._tetrimino),e._tetrimino=e._tetrimino=new _("O")),e._fallCount=0}),this),this.input.keyboard.addKey("r").on("down",(function(){n._tetrimino.rotate("Clockwise",n._field)})),this.input.keyboard.addKey("e").on("down",(function(){o._tetrimino.rotate("Counterclockwise",o._field)})),this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE).on("down",(function(){for(var t=0;t<64;t++){if(i._tetrimino.position==i._tetrimino.move("Down",i._field).position)break}i._fallCount=99999}),this),this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT).on("down",(function(){r._tetrimino.move("Left",r._field)}),this),this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT).on("down",(function(){a._tetrimino.move("Right",a._field)}),this)}},{key:"update",value:function(){if(this._frame+=1,this._counter.setText(this._frame.toString()),this._pointerText.setText("(".concat(this.input.activePointer.worldX.toFixed(0),", ").concat(this.input.activePointer.worldY.toFixed(0),")")),this.draw(),this._fallCount++,this._fallCount>60){if(this._tetrimino.position==this._tetrimino.move("Down",this._field).position){this._field.put(this._tetrimino);var t=["I","O","S","Z","J","L","T"];this._tetrimino=this._tetrimino=new _(t[Math.floor(Math.random()*t.length)])}this._fallCount=0}}},{key:"draw",value:function(){for(var t=this,e=this;0!=this._objs.length;){this._objs.pop().destroy()}this._field.field.forEach((function(e,n){var o=t;e.forEach((function(t,e){switch(t){case"None":break;case"Block":o._objs.push(o.add.rectangle(e*p.width+y.offset.x,n*p.height+y.offset.y,p.width-1,p.height-1,3421236));break;case"Wall":o._objs.push(o.add.rectangle(e*p.width+y.offset.x,n*p.height+y.offset.y,p.width,p.height,1193046))}}))})),this._tetrimino.parts.forEach((function(t,n){var o=e;t.forEach((function(t,e){switch(t){case"None":break;case"Block":o._objs.push(o.add.rectangle((e+o._tetrimino.position.x)*p.width+y.offset.x,(n+o._tetrimino.position.y)*p.height+y.offset.y,19,19,16711680))}}))}))}}]),n}(),y=function(){function t(){r(this,t),this._field=Array.from(new Array(t.size.height),(function(){return new Array(t.size.width).fill("None")})),this._createWall(),console.log(this._field)}return s(t,[{key:"_createWall",value:function(){var t=this,e=this._field[0].length,n=this._field.length;this._field.forEach((function(n,o){t._field[o][0]="Wall",t._field[o][e-1]="Wall"})),this._field[0].fill("TopPos"),this._field[1].fill("TopPos"),this._field[2].fill("TopPos"),this._field[n-1].fill("Wall")}},{key:"field",get:function(){return this._field}},{key:"put",value:function(e){var n=this;e.parts.forEach((function(o,i){var r=n;o.forEach((function(n,o){if("Block"==n&&!(i+e.position.y>=t.size.height||o+e.position.x>=t.size.width)){var a=r._field[i+e.position.y][o+e.position.x];"None"!=a&&"Wall"!=a||(r._field[i+e.position.y][o+e.position.x]="Block")}}))}))}}]),t}();y.size=new Phaser.Geom.Rectangle(0,0,12,24),y.offset=new Phaser.Math.Vector2(p.width/2+40,p.height/2);var _=function(){function t(e){var n;switch(r(this,t),this._partsState=0,this._type=e,this._type){case"O":n=[[["X","X"],["X","X"]]];break;case"T":n=[[[" "," "," "],["X","X","X"],[" ","X"," "]],[[" ","X"," "],["X","X"," "],[" ","X"," "]],[[" ","X"," "],["X","X","X"],[" "," "," "]],[[" ","X"," "],[" ","X","X"],[" ","X"," "]]];break;case"I":n=[[[" ","X"," "," "],[" ","X"," "," "],[" ","X"," "," "],[" ","X"," "," "]],[[" "," "," "," "],[" "," "," "," "],["X","X","X","X"],[" "," "," "," "]]];break;case"S":n=[[[" ","X","X"],["X","X"," "],[" "," "," "]],[["X"," "," "],["X","X"," "],[" ","X"," "]]];break;case"Z":n=[[["X","X"," "],[" ","X","X"],[" "," "," "]],[[" "," ","X"],[" ","X","X"],[" ","X"," "]]];break;case"J":n=[[[" ","X"," "],[" ","X"," "],["X","X"," "]],[["X"," "," "],["X","X","X"],[" "," "," "]],[[" ","X","X"],[" ","X"," "],[" ","X"," "]],[[" "," "," "],["X","X","X"],[" "," ","X"]]];break;case"L":n=[[[" ","X"," "],[" ","X"," "],[" ","X","X"]],[[" "," "," "],["X","X","X"],["X"," "," "]],[["X","X"," "],[" ","X"," "],[" ","X"," "]],[[" "," ","X"],["X","X","X"],[" "," "," "]]]}this._parts=n.map((function(t){return t.map((function(t){return t.map((function(t){return"X"==t?"Block":"None"}))}))})),this._position=new Phaser.Math.Vector2(5,1)}return s(t,[{key:"move",value:function(t,e){var n=new Phaser.Math.Vector2(this._position);switch(t){case"Down":n.y+=1;break;case"Left":n.x-=1;break;case"Right":n.x+=1}return this._collide(n,e)||(this._position=new Phaser.Math.Vector2(n)),this}},{key:"rotate",value:function(t,e){var n=this._partsState,o=(this._partsState+("Clockwise"==t?1:this._parts.length-1))%this._parts.length;if(this._partsState=o,this._collide(this._position,e)){var i=this,r=!1,a=new Phaser.Math.Vector2(0,0),s=[];if("I"==this._type){var c=[0,1,-1,2,-2];(s=[0,1,2,-1,-2].map((function(t){return c.map((function(e){return new Phaser.Math.Vector2(e,t)}))})).flat()).shift()}else{var f=[0,1,-1];(s=[0,1,-1].map((function(t){return f.map((function(e){return new Phaser.Math.Vector2(e,t)}))})).flat()).shift()}return s.forEach((function(t){if(!i._collide(new Phaser.Math.Vector2(i._position).add(new Phaser.Math.Vector2(t)),e))return r=!0,void(a=t)})),r?this._position=this._position.add(a):this._partsState=n,this}return this}},{key:"_collide",value:function(t,e){var n=!1;return this._parts[this._partsState].forEach((function(o,i){n||o.forEach((function(o,r){if("Block"==o){if(i+t.y>=y.size.height||r+t.x>=y.size.width)return;var a=e.field[i+t.y][r+t.x];if("Block"==a||"Wall"==a)return n=!0,!1}}))})),n}},{key:"position",get:function(){return this._position},set:function(t){this._position=t}},{key:"parts",get:function(){return this._parts[this._partsState]}}]),t}(),b=d;function w(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return!e||"object"!==g(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function k(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return v(this,n)}}new Phaser.Geom.Rectangle(0,0,20,20);var P=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(r,Phaser.Scene);var e,n,o,i=k(r);function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this,{key:"Title"})}return e=r,(n=[{key:"preload",value:function(){console.log("preload")}},{key:"create",value:function(){var t=this;console.log(this),this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0).setOrigin(0,0),this.add.text(10,10,"TETRIS",{fontSize:"32px"}),this.add.text(10,60,"\u307e\u3060\u958b\u767a\u4e2d\u3067\u3059\u2026\u2026"),this.add.text(10,80,"\u753b\u9762\u3092\u30bf\u30c3\u30d7\u3059\u308c\u3070\u30b2\u30fc\u30e0\u30b9\u30bf\u30fc\u30c8"),this.add.text(10,130,"\u2190\u2192:\u30c6\u30c8\u30ea\u30df\u30ce\u5de6\u53f3\u79fb\u52d5"),this.add.text(10,150,"S:\u30c6\u30c8\u30ea\u30df\u30ce\u4e0b\u79fb\u52d5"),this.add.text(10,170,"SPACE: \u30c6\u30c8\u30ea\u30df\u30ce\u843d\u4e0b"),this.add.text(10,190,"E: \u56de\u8ee2"),this.input.once("pointerdown",(function(){console.log("Scene change"),t.cameras.main.fadeOut(300).on("camerafadeoutcomplete",(function(){this.scene.start("Main")}),t)}))}},{key:"update",value:function(){}}])&&w(e.prototype,n),o&&w(e,o),r}();function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return!e||"object"!==E(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function j(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=O(t);if(e){var i=O(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return x(this,n)}}var R={width:300,height:500,type:Phaser.AUTO,pixelArt:!1,backgroundColor:13487565,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_VERTICALLY,parent:"game"},scene:[P,b]},C=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(n,Phaser.Game);var e=j(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(),T=function(t){var e=t.className;return(0,i.useEffect)((function(){new C(R)}),[]),(0,o.jsx)("div",{id:"game",className:e})}}}]);